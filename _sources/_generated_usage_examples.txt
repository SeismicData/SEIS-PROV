Usage Examples
--------------

This section shows some more extensive examples demonstrating that
``SEIS-PROV`` can be used to capture provenance for a wide range of
seismological relevant applications. Keep in mind that these diagrams describe
the history of some piece of data, not a workflow. The **arrows point towards
the past**, e.g. to the origin/history of any piece of data.

.. note::
    `Right click -> View Image` to see the graphs in more detail.

.. contents::
    :local:
    :depth: 1


Detailed Processing Chain
^^^^^^^^^^^^^^^^^^^^^^^^^^

This example demonstrates how a linear chain of signal processing routines can
be described.  The data has been detrended with a linear fit, then a
Butterworth lowpass filter has been applied and finally some integer decimation
has been performed. All of these operations where performed by a certain
version of ObsPy. Toolboxes can be adapted to provide this kind of provenance
information fully automatic.

.. raw:: html

    <div id="tab-container" class="tab-container">
      <ul class='etabs'>
        <li class='tab'>
            <a href="#tabs-example_detailed_processing_chain-graph">Graph</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_detailed_processing_chain-python">Python Code</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_detailed_processing_chain-xml">PROV-XML</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_detailed_processing_chain-json">PROV-JSON</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_detailed_processing_chain-provn">PROV-N</a>
        </li>
      </ul>
      <div class="tab-contents" id="tabs-example_detailed_processing_chain-graph">

.. graphviz:: _generated/dot/examples/example_detailed_processing_chain.dot

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_detailed_processing_chain-python">

Python code utilizing the `prov <http://prov.readthedocs.org/>`_ package.

.. literalinclude:: _generated/py/examples/example_detailed_processing_chain.py
    :language: python

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_detailed_processing_chain-xml">

In the `PROV-XML <http://www.w3.org/TR/prov-xml/>`_ serialization.

.. literalinclude:: _generated/xml/examples/example_detailed_processing_chain.xml
    :language: xml

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_detailed_processing_chain-json">

In the
`PROV-JSON <http://www.w3.org/Submission/2013/SUBM-prov-json-20130424/>`_
serialization.

.. literalinclude:: _generated/json/examples/example_detailed_processing_chain.json
    :language: json

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_detailed_processing_chain-provn">

In `PROV-N <http://www.w3.org/TR/prov-n/>`_ notation.

.. literalinclude:: _generated/provn/examples/example_detailed_processing_chain.provn

.. raw:: html

    </div>
    </div>


Schematic Processing Chain
^^^^^^^^^^^^^^^^^^^^^^^^^^

Sometimes not all information needs to be captured for a given application and
SEIS PROV is flexible enough to also allow a qualitative description of a
workflow. This is the same example as above but with less information. This
could be treated as a schema on how to process a large amount of data
independent of the used software and actual data.

.. raw:: html

    <div id="tab-container" class="tab-container">
      <ul class='etabs'>
        <li class='tab'>
            <a href="#tabs-example_schematic_processing_chain-graph">Graph</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_schematic_processing_chain-python">Python Code</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_schematic_processing_chain-xml">PROV-XML</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_schematic_processing_chain-json">PROV-JSON</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_schematic_processing_chain-provn">PROV-N</a>
        </li>
      </ul>
      <div class="tab-contents" id="tabs-example_schematic_processing_chain-graph">

.. graphviz:: _generated/dot/examples/example_schematic_processing_chain.dot

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_schematic_processing_chain-python">

Python code utilizing the `prov <http://prov.readthedocs.org/>`_ package.

.. literalinclude:: _generated/py/examples/example_schematic_processing_chain.py
    :language: python

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_schematic_processing_chain-xml">

In the `PROV-XML <http://www.w3.org/TR/prov-xml/>`_ serialization.

.. literalinclude:: _generated/xml/examples/example_schematic_processing_chain.xml
    :language: xml

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_schematic_processing_chain-json">

In the
`PROV-JSON <http://www.w3.org/Submission/2013/SUBM-prov-json-20130424/>`_
serialization.

.. literalinclude:: _generated/json/examples/example_schematic_processing_chain.json
    :language: json

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_schematic_processing_chain-provn">

In `PROV-N <http://www.w3.org/TR/prov-n/>`_ notation.

.. literalinclude:: _generated/provn/examples/example_schematic_processing_chain.provn

.. raw:: html

    </div>
    </div>


Waveform Simulation
^^^^^^^^^^^^^^^^^^^

This fairly realistic example demonstrates how the waveform files resulting
from a numerical simulation can be described. This example does use some of the
more advanced future of the W3C PROV data model which are useful in many
contexts. Note that the waveform simulation activity has start- and endtimes
and that SPECFEM in this example actually has been steered by a certain person.

The amount of information to store has to be decided by the given application.
The general idea is to store those input file parameters that actually have an
effect on the output. It might also be useful to store information about the
machine is was run on in the provenance information but that is not shown here.

Additionally in this case the provenance also contains a reference to a source
code file which might often be user defined and thus is crucial to the final
result of the simulation.

The implementation of this in a waveform solver is fairly simple by just using
an existing SEIS PROV XML file as a template and adjusting the information
dynamically. No need to incorporate an actual XML library.

.. raw:: html

    <div id="tab-container" class="tab-container">
      <ul class='etabs'>
        <li class='tab'>
            <a href="#tabs-example_waveform_simulation-graph">Graph</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_waveform_simulation-python">Python Code</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_waveform_simulation-xml">PROV-XML</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_waveform_simulation-json">PROV-JSON</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_waveform_simulation-provn">PROV-N</a>
        </li>
      </ul>
      <div class="tab-contents" id="tabs-example_waveform_simulation-graph">

.. graphviz:: _generated/dot/examples/example_waveform_simulation.dot

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_waveform_simulation-python">

Python code utilizing the `prov <http://prov.readthedocs.org/>`_ package.

.. literalinclude:: _generated/py/examples/example_waveform_simulation.py
    :language: python

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_waveform_simulation-xml">

In the `PROV-XML <http://www.w3.org/TR/prov-xml/>`_ serialization.

.. literalinclude:: _generated/xml/examples/example_waveform_simulation.xml
    :language: xml

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_waveform_simulation-json">

In the
`PROV-JSON <http://www.w3.org/Submission/2013/SUBM-prov-json-20130424/>`_
serialization.

.. literalinclude:: _generated/json/examples/example_waveform_simulation.json
    :language: json

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_waveform_simulation-provn">

In `PROV-N <http://www.w3.org/TR/prov-n/>`_ notation.

.. literalinclude:: _generated/provn/examples/example_waveform_simulation.provn

.. raw:: html

    </div>
    </div>


Cross Correlation
^^^^^^^^^^^^^^^^^

.. raw:: html

    <div id="tab-container" class="tab-container">
      <ul class='etabs'>
        <li class='tab'>
            <a href="#tabs-example_cross_correlation-graph">Graph</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_cross_correlation-python">Python Code</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_cross_correlation-xml">PROV-XML</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_cross_correlation-json">PROV-JSON</a>
        </li>
        <li class='tab'>
            <a href="#tabs-example_cross_correlation-provn">PROV-N</a>
        </li>
      </ul>
      <div class="tab-contents" id="tabs-example_cross_correlation-graph">

.. graphviz:: _generated/dot/examples/example_cross_correlation.dot

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_cross_correlation-python">

Python code utilizing the `prov <http://prov.readthedocs.org/>`_ package.

.. literalinclude:: _generated/py/examples/example_cross_correlation.py
    :language: python

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_cross_correlation-xml">

In the `PROV-XML <http://www.w3.org/TR/prov-xml/>`_ serialization.

.. literalinclude:: _generated/xml/examples/example_cross_correlation.xml
    :language: xml

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_cross_correlation-json">

In the
`PROV-JSON <http://www.w3.org/Submission/2013/SUBM-prov-json-20130424/>`_
serialization.

.. literalinclude:: _generated/json/examples/example_cross_correlation.json
    :language: json

.. raw:: html

    </div>
    <div class="tab-contents" id="tabs-example_cross_correlation-provn">

In `PROV-N <http://www.w3.org/TR/prov-n/>`_ notation.

.. literalinclude:: _generated/provn/examples/example_cross_correlation.provn

.. raw:: html

    </div>
    </div>
